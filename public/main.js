var placesData = [
  {
    region: "NEW YORK",
    coordenates: {
      lat: 40.781096551750224,
      lng: -73.3363097956825,
    },
    zoomLevel: 9.4,
    locations: [
      {
        name: "THE BARN",
        slug: "BARN",
        address: "264 Butter Lane Bridge Hampton, NY 11932",
        instructions: "*Parking available on site",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 40.940855743594824,
          lng: -72.31293382893323,
        },
      },
      {
        name: "SOHO, NY",
        slug: "SOHO",
        address: "62 Grand St, New York, NY 10013",
        instructions: "*In between West Broadway and Wooster",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 40.722362790754836,
          lng: -74.00325818713509,
        },
      },
      {
        name: "BROOKLYN, NY",
        slug: "BRK",
        address: "Coming Soon",
        instructions: "",
      },
    ],
  },
  {
    region: "FLORIDA",
    coordenates: {
      lat: 26.011454704999394,
      lng: -80.20126016836194,
    },
    zoomLevel: 9,
    locations: [
      {
        name: "MIAMI BEACH, FL",
        slug: "MIAMI",
        address: "1935 West Avenue #208, Miami Beach, FL 33139",
        instructions: "*Street & 1900 Bay Road garage parking",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.79537581399364,
          lng: -80.14217057891659,
        },
      },
      {
        name: "AVENTURA, FL",
        slug: "AVENT",
        address: "2775 NE 187th street Suite 3 Aventura, FL 33180",
        instructions: "*Complimentary parking lot",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.94972374351693,
          lng: -80.14398435244337,
        },
      },
      {
        name: "CORAL GABLES, FL",
        slug: "CORAL",
        address: "4203 Ponce de Leon Blvd, Coral Gables, FL 33146",
        instructions: "*Street parking",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.733037691503426,
          lng: -80.25822483635295,
        },
      },
      {
        name: "MIDTOWN, FL",
        slug: "MIDT",
        address: "131 NE 34th Street CU6/108, Miami, FL 33137 (near the Hyde)",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.808499438453655,
          lng: -80.19204272474077,
        },
      },
      {
        name: "SOUTH MIAMI, FL",
        slug: "SOMI",
        address: "6448 S Dixie Hwy D, South Miami, FL 33143",
        instructions: "*Complimentary parking lot",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.6970276679542,
          lng: -80.29754694331854,
        },
      },
      {
        name: "COCONUT GROVE, FL",
        slug: "GROVE",
        address:
          "2675 South Bayshore Drive. Coconut Grove, FL inside the gallery.",
        instructions:
          "* Public parking available across the street along Pan American Drive. *No bike parking inside studio or on condo premise.",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.730072711296383,
          lng: -80.23657646283114,
        },
      },
      {
        name: "BRICKELL, FL",
        slug: "BRICK",
        address:
          "1060 Brickell Ave. Miami, FL 33131, M3/105 (Physical ID is required to access the building)",
        instructions:
          "*Take elevators to the left to floor M or take stairs inside lobby to floor M.",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 25.76315320005587,
          lng: -80.19189894062967,
        },
      },
      {
        name: "FORT LAUDERDALE, FL",
        slug: "FTL",
        address: "",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
      },
      {
        name: "WEST PALM BEACH, FL",
        slug: "WPB",
        address: "2805 S Dixie Highway West Palm Beach, FL 33405",
        instructions:
          "This is a new development and the address is not accurate yet on Google Maps. Please use Josephs Market West Palm on GPS. We are located on Dixie, in between Salons by JC and Restore Hyper Wellness.",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 26.68849141311584,
          lng: -80.05474310675662,
        },
      },
      {
        name: "EAST BOCA, FL",
        slug: "BOCA",
        address: "201 Plaza Real , Suite 1209 Boca Raton, FL 33432",
        instructions:
          "When using GPS, the address will take you to the opposite side of the building. There is metered street parking or 4 free parking garages. We recommend parking in Garage B. The unit is located across from iPIC and adjacent to Prenuvo.",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 26.352789576991245,
          lng: -80.08588147359535,
        },
      },
      {
        name: "DORAL, FL",
        slug: "DORAL",
        address: "7901 NW 36 ST Suite 109 Doral, FL 33166",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          link: "#",
        },
        coordenates: {
          lat: 25.809355538997398,
          lng: -80.3252913378509,
        },
      },
    ],
  },
  {
    region: "NEVADA",
    zoomLevel: 10.5,
    coordenates: {
      lat: 39.43743943379793,
      lng: -119.76348088068596,
    },
    locations: [
      {
        name: "SOUTH RENO, NV",
        slug: "RENO",
        address:
          "15425 Wedge Parkway Suite 110, Reno, NV 89511, South Reno Line  775-505-3225",
        instructions: "*Complimentary parking lot",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 39.40620113540004,
          lng: -119.76026540267547,
        },
      },
      {
        name: "RENO, NV (Caughlin Ranch)",
        slug: "RENO",
        address: "4788 Caughlin Parkway Suite 213 Reno NV 89519",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 39.482880390933246,
          lng: -119.85385670370903,
        },
      },
    ],
  },
  {
    region: "LOUISIANA",
    zoomLevel: 15.5,
    coordenates: {
      lat: 30.134851694930312,
      lng: -91.9746293857689,
    },
    locations: [
      {
        name: "LAFAYETTE, LA",
        slug: "LAFAY",
        address: "1137 South Bernard Road, Suite O Broussard, LA 70518",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 30.135265718075395,
          lng: -91.97450699942483,
        },
      },
    ],
  },
  {
    region: "SOUTH CAROLINA",
    coordenates: {
      lat: 33.98790350208778,
      lng: -81.00074477401023,
    },
    zoomLevel: 15.5,
    locations: [
      {
        name: "COLUMBIA, SC",
        slug: "COLUM",
        address: "3000 Rosewood Drive, Columbia, SC 29205",
        instructions: "",
        link: {
          text: "VIEW DETAILS",
          url: "#",
        },
        coordenates: {
          lat: 33.987966285944076,
          lng: -81.0007566445345,
        },
      },
    ],
  },
];

var markers = [];
var infoWindows = [];

var initCoordenates = {
  lat: 36.24431659260382,
  lng: -96.81130652487239,
};

function toggleDropdown() {
  var dropdown = document.querySelector(".mit__dropdown-choises");
  dropdown.classList.toggle("mit__dropdown--show");
}

function choiseSelected(choise) {
  var button = document.querySelector(".mit__btn-text");
  button.textContent = choise;

  var places = document.querySelectorAll(".mit__place");

  places.forEach(function (place) {
    place.classList.remove("mit__place--hidden");

    if (choise !== "all studios" && place.id !== `mit-place-${choise}`) {
      place.classList.add("mit__place--hidden");
    }
  });

  if (choise === "all studios") {
    currentMap.setZoom(4.4);
    currentMap.setCenter(initCoordenates);
  } else {
    var targetPlace = placesData.find(function (place) {
      return place.region === choise;
    });

    currentMap.setZoom(targetPlace.zoomLevel);

    currentMap.setCenter(targetPlace.coordenates);
  }

  infoWindows.forEach(function (infoWindow) {
    infoWindow.close();
  });

  // hide some markers
  markers.forEach(function (marker) {
    marker.setVisible(false);

    if (choise === "all studios") {
      return marker.setVisible(true);
    }

    if (choise === marker.title.split("/")[0]) {
      marker.setVisible(true);
    } else {
      marker.setVisible(false);
    }
  });

  // close dropdown
  toggleDropdown();
}

var currentMap = null;

function initMap() {
  var targetMap = document.getElementById("map");
  if (targetMap) {
    currentMap = new google.maps.Map(targetMap, {
      center: initCoordenates,
      zoom: 4.4,
      mapId: "19823be07f1aa517",
      mapTypeControl: false,
      scaleControl: false,
      streetViewControl: false,
      rotateControl: false,
      fullscreenControl: false,
    });

    placesData.forEach(function (place) {
      place.locations.forEach(function (location) {
        var marker = new google.maps.Marker({
          position: location.coordenates,
          map: currentMap,
          title: `${place.region}/${location.name}`,
        });

        var infoWindow = new google.maps.InfoWindow({
          content: `
            <div class="mit-map-popup">
              <h3 class="mit-map-title">${location.name}</h3>
              <p class="mit-map-address">${location.address}</p>
              <a class="mit-map-link" href="${location.link}">View DETAILS</a>
            </div>
          `,
        });

        markers.push(marker);
        infoWindows.push(infoWindow);

        // on mouse over
        marker.addListener("mouseover", function () {
          infoWindows.forEach(function (infoWindow) {
            infoWindow.close();
          });

          infoWindow.open(currentMap, marker);
        });
      });
    });
  }
}

function App() {
  var target = document.querySelector("[data-section-id='app']");

  // create a div with id="app" next to the section
  var div = document.createElement("div");
  div.id = "app";
  target.parentNode.insertBefore(div, target.nextSibling);

  var app = document.getElementById("app");

  // return html with all locations
  var regionsHTML = placesData.map(function (location) {
    return `
      <li>
        <button class="mit__region" onclick="choiseSelected('${location.region}')">
          ${location.region}
        </button>
      </li>
    `;
  });

  var regionsTemplate = regionsHTML.join("");

  var locationsHTML = placesData.map(function (location) {
    var locationsRender = location.locations.map(function (location) {
      if (location.link) {
        return `
          <li class="mit__location">
            <div class="mit__location-link mit--no-cursor">
              <span class="mit__location-slug">${location.slug}</span>
              <p class="mit__location-name">${location.name}</p>
              <p class="mit__location-address">${location.address}</p>
              <p class="mit__location-instructions">${location.instructions}</p>
              <a class="mit__location-button" href="${location.link.url}">${location.link.text}</a>
            </div>
          </li>
        `;
      }

      return `
          <li class="mit__location">
            <div class="mit__location-link mit--no-cursor">
              <span class="mit__location-slug">${location.slug}</span>
              <p class="mit__location-name">${location.name}</p>
              <p class="mit__location-address">${location.address}</p>
              <p class="mit__location-instructions">${location.instructions}</p>
            </div>
          </li>
        `;
    });

    return `
      <div class="mit__place" id="mit-place-${location.region}">
        <h3 class="mit__place-title">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" style="width: 32px; height: 32px; margin-right: 6px;">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z" />
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z" />
          </svg>
          ${location.region}</h3>
        <ul class="mit__locations">
          ${locationsRender.join("")}
        </ul>
      </div>
    `;
  });

  var locationsTemplate = locationsHTML.join("");

  var template = `
    <section class="hero">
      <div class="hero__content">
        <span class="hero__badge">
          Sweat Today, Shine Tomorrow
        </span>
        <h1 class="hero__title">
          Unleash Your Strength.<br/> Your Ultimate Gym Experience
        </h1>
        <p class="hero__description">
          Transform Your Body, Transform Your Life. Discover a world-class fitness experience tailored to your goals at our premier gym. Join us and unleash your full potential today!
        </p>
        
        <a href="#explorer" class="hero__button">
          Let's Get Started
        </a>
      </div>
      <div class="hero__graphics">
        <img src="/men.png" width="350px" height="auto" class="hero__image" />
      </div>
    </section>
    <button type="button" class="mit__btn" id="explorer" onclick="toggleDropdown()">
      <span class="mit__btn-text">All studios</span>
      <svg class="mit__arrow-down" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5" />
      </svg>
    </button>
    <ul class="mit__dropdown-choises">
      <li>
        <button class="mit__region" onclick="choiseSelected('all studios')">
          All Studios
        </button>
      </li>
      ${regionsTemplate}
    </ul>
    <div id="map">
    </div>
    <div class="mit__place-list">
      ${locationsTemplate}
    </div>

    <footer>
      Created by <a href="https://www.luisfalconmx.dev/" target="_blank">luisfalconmx</a>
    </footer>
  `;

  app.innerHTML = template;
}

App();
